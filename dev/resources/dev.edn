{:duct.profile/base
 #audiophile/merge
 [#duct/include "duct/api/base.edn"
  {[:duct/const :resources/migration-path]
   "db/migrations"}]

 :duct.profile/dev
 {[:duct/const :routes/table]
  ^:promote {[:get :auth/login]    #ig/ref :com.ben-allred.audiophile.api.dev.handler/login
             [:get :auth/callback] #ig/ref :com.ben-allred.audiophile.api.dev.handler/callback}

  [:com.ben-allred.audiophile.api.core/server :duct/daemon]
  {:handler     #ig/ref :api/handler
   :server-port #ig/ref :env/server-port}

  :com.ben-allred.audiophile.api.dev.handler/app
  {:app #ig/ref :com.ben-allred.audiophile.api.handlers.core/app}

  ;; components
  :com.ben-allred.audiophile.api.dev.handler/login
  {:base-url #ig/ref :env/base-url
   :nav      #ig/ref :services/nav}

  :com.ben-allred.audiophile.api.dev.handler/callback
  {:base-url  #ig/ref :env/base-url
   :jwt-serde #ig/ref :serdes/jwt
   :nav       #ig/ref :services/nav
   :user-repo #ig/ref :repositories/users}}}
